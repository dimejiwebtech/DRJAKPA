{% extends 'base.html' %} 

{% block title %}Search Results{% if query %} for "{{ query }}"{% endif %} - Dr. Jakpa{% endblock %} 

{% block description %}Search results for medical migration insights, German licensing guides, and professional relocation resources.{% endblock %} 

{% block og_title %}Search Results - Dr. Jakpa Blog{% endblock %} 

{% block content %}

<header class="pt-32 pb-12 bg-royal text-white">
  <div class="max-w-7xl mx-auto px-6">
    <div class="reveal">
      <span
        class="text-accent font-bold tracking-[0.3em] text-[10px] uppercase mb-2 block"
        >System Query</span
      >
      <h1 class="text-3xl font-extrabold uppercase tracking-tighter mb-6">
        {% if query %} Results for:
        <span class="text-accent italic">"{{query}}"</span>
        {% else %} Search Results {% endif %}
      </h1>
      <form method="GET" action="{% url 'search' %}" class="relative max-w-2xl">
        <input
          type="text"
          name="q"
          value="{{query}}"
          placeholder="Search articles..."
          class="w-full bg-white/10 border border-white/20 rounded-lg py-4 px-6 text-sm text-white focus:outline-none focus:bg-white/20 transition-all"
        />
        <button
          type="submit"
          class="absolute right-2 top-2 bg-accent p-2 rounded-md hover:bg-orange-600 transition-colors"
        >
          <i data-lucide="search" class="w-5 h-5"></i>
        </button>
      </form>
    </div>
  </div>
</header>

<main class="py-16 bg-neutralBg">
  <div class="max-w-7xl mx-auto px-6 grid lg:grid-cols-12 gap-12">
    <aside class="lg:col-span-3 space-y-8">
      <div
        class="reveal-left bg-white p-8 rounded-xl border border-slate-200 shadow-sm"
      >
        <h3
          class="text-xs font-bold text-royal uppercase tracking-widest mb-6 border-b border-slate-100 pb-4"
        >
          Filter By Category
        </h3>
        <div class="space-y-4">
          {% for category in categories %}
          <div class="flex items-center gap-3">
            <a
              href="{% url 'posts_by_category_or_post' category.slug %}"
              class="text-xs font-medium text-slate-500 hover:text-royal cursor-pointer transition-colors"
              >{{category.name}}</a
            >
          </div>
          {% endfor %}
        </div>
      </div>

      <div
        class="reveal-left bg-royal p-8 rounded-xl text-white shadow-xl"
        style="transition-delay: 100ms"
      >
        <h4
          class="text-[10px] font-bold uppercase tracking-widest mb-4 text-accent"
        >
          Assistance Needed?
        </h4>
        <p class="text-[11px] opacity-70 mb-6 leading-relaxed">
          Our agency helps Nigerian doctors migrate to Germany legally. Speak to
          a consultant for custom guidance.
        </p>
        <a
          href="{% url 'bookings' %}"
          class="block w-full text-center bg-white text-royal font-bold py-3 rounded text-[10px] uppercase tracking-widest hover:bg-accent hover:text-white transition-all"
          >Book Session</a
        >
      </div>
    </aside>

    <div class="lg:col-span-9 space-y-6">
      <div class="reveal flex justify-between items-center mb-4 px-2">
        <p
          class="text-[11px] font-bold text-slate-400 uppercase tracking-widest"
        >
          {% if posts %} Showing {{posts.start_index}}-{{posts.end_index}} of {{posts.paginator.count}} Results {% else %} No Results Found 
          {% endif %}
        </p>
      </div>

      {% if posts %} 
      
      {% for post in posts %}
      <article
        class="reveal result-card bg-white p-8 rounded-xl border border-slate-200 border-l-4 border-l-transparent shadow-sm hover:shadow-md transition-all"
      >
        <div class="flex justify-between items-start mb-4">
          {% for cat in post.category.all %}
          <span
            class="text-accent text-[9px] font-black uppercase tracking-[0.2em] bg-orange-50 px-2 py-1 rounded"
            >{{cat.name}}</span
          >
          {% endfor %}
          <span class="text-[10px] text-slate-300 font-bold uppercase"
            >{{post.published_date|date:"M d, Y"}}</span
          >
        </div>
        <h2 class="text-xl font-bold text-royal mb-3">{{post.title}}</h2>
        <p class="text-sm text-slate-500 leading-relaxed mb-6 line-clamp-2">
          {{post.excerpt|safe|truncatewords:30}}
        </p>
        <div class="flex items-center gap-6">
          <a
            href="{% url 'posts_by_category_or_post' post.slug %}"
            class="text-royal font-bold text-[11px] uppercase tracking-widest flex items-center gap-2"
            >View Full Resource
            <i data-lucide="arrow-right" class="w-3 h-3 text-accent"></i
          ></a>
        </div>
      </article>
      {% endfor %} 
      {% if posts.has_other_pages %}
      <div class="reveal flex justify-center items-center gap-4 pt-10">
        {% if posts.has_previous %}
        <a
          href="?q={{query}}&page={{posts.previous_page_number}}"
          class="w-10 h-10 border border-slate-200 rounded flex items-center justify-center text-slate-400 hover:border-royal hover:text-royal transition-all"
          ><i data-lucide="chevron-left" class="w-4 h-4"></i
        ></a>
        {% else %}
        <button
          disabled
          class="w-10 h-10 border border-slate-200 rounded flex items-center justify-center text-slate-300 cursor-not-allowed"
        >
          <i data-lucide="chevron-left" class="w-4 h-4"></i>
        </button>
        {% endif %}

        <span class="text-xs font-bold text-royal"
          >Page {{posts.number}} of {{posts.paginator.num_pages}}</span
        >

        {% if posts.has_next %}
        <a
          href="?q={{query}}&page={{posts.next_page_number}}"
          class="w-10 h-10 border border-slate-200 rounded flex items-center justify-center text-slate-400 hover:border-royal hover:text-royal transition-all"
          ><i data-lucide="chevron-right" class="w-4 h-4"></i
        ></a>
        {% else %}
        <button
          disabled
          class="w-10 h-10 border border-slate-200 rounded flex items-center justify-center text-slate-300 cursor-not-allowed"
        >
          <i data-lucide="chevron-right" class="w-4 h-4"></i>
        </button>
        {% endif %}
      </div>
      {% endif %} {% else %}
      <div class="text-center py-20">
        <i
          data-lucide="search-x"
          class="w-16 h-16 mx-auto text-slate-300 mb-4"
        ></i>
        <h2
          class="text-2xl font-bold text-royal uppercase tracking-tighter mb-2"
        >
          No Results Found
        </h2>
        <p class="text-sm text-slate-500">
          Try searching with different keywords
        </p>
      </div>
      {% endif %}
    </div>
  </div>
</main>

{% endblock %}
